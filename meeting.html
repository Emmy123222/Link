<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VUNO - Modern Team Collaboration</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- Tailwind Custom Config -->
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        screens: {
          sm: '640px',
          md: '768px',
          lg: '1024px',
          xl: '1280px',
          '2xl': '1536px',
        },
        extend: {
          fontFamily: {
            sans: ['"Inter Variable"', 'Inter', 'system-ui', 'sans-serif'],
            display: ['"Geist Variable"', '"Geist"', 'Inter', 'system-ui', 'sans-serif'],
            mono: ['"Geist Mono Variable"', '"Geist Mono"', 'monospace'],
          },
          colors: {
            primary: {
              50: '#f0f9ff',
              100: '#e0f2fe',
              200: '#bae6fd',
              300: '#7dd3fc',
              400: '#38bdf8',
              500: '#0ea5e9',
              600: '#0284c7',
              700: '#0369a1',
              800: '#075985',
              900: '#0c4a6e',
            },
            background: {
              light: '#ffffff',
              dark: '#0a0a0a',
            },
            surface: {
              light: '#f8fafc',
              dark: '#1a1a1a',
            },
            text: {
              primary: {
                light: '#18181b',
                dark: '#fafafa',
              },
              secondary: {
                light: '#52525b',
                dark: '#a1a1aa',
              }
            },
            border: {
              light: '#e4e4e7',
              dark: '#3f3f46',
            }
          },
          animation: {
            'fade-in': 'fadeIn 0.3s ease-in-out forwards',
            'slide-in': 'slideIn 0.3s ease-out forwards',
            'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
          },
          keyframes: {
            fadeIn: {
              '0%': { opacity: '0' },
              '100%': { opacity: '1' },
            },
            slideIn: {
              '0%': { transform: 'translateY(-20px)', opacity: '0' },
              '100%': { transform: 'translateY(0)', opacity: '1' },
            },
          }
        }
      }
    };
  </script>

  <!-- Custom Styles -->
  <style>
    @import url('https://cdn.jsdelivr.net/npm/@fontsource-variable/inter@5.0.3/index.min.css');
    @import url('https://cdn.jsdelivr.net/npm/@fontsource-variable/geist-sans@1.1.1/index.min.css');
    @import url('https://cdn.jsdelivr.net/npm/@fontsource-variable/geist-mono@1.1.1/index.min.css');

    body {
      @apply font-sans text-text-primary-light bg-background-light dark:text-text-primary-dark dark:bg-background-dark;
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
    }

    .active-scale {
      transition: transform 0.1s ease, box-shadow 0.1s ease;
    }
    .active-scale:active {
      transform: scale(0.97);
    }

    .transition-smooth {
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .border-light {
      @apply border border-border-light dark:border-border-dark;
    }

    .message-in {
      border-radius: 18px 18px 18px 4px;
      @apply bg-surface-light text-text-primary-light;
    }
    .dark .message-in {
      @apply bg-surface-dark text-text-primary-dark; 
    }

    .message-out {
      border-radius: 18px 18px 4px 18px;
      @apply bg-primary-600 text-white;
    }

    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    ::-webkit-scrollbar-track {
      @apply bg-transparent;
    }
    ::-webkit-scrollbar-thumb {
      @apply bg-border-light dark:bg-border-dark rounded-full;
    }
    ::-webkit-scrollbar-thumb:hover {
      @apply bg-primary-400 dark:bg-primary-600;
    }

    @media (min-width: 1024px) {
      .main-content {
        margin-left: 20rem;
      }
      .mobile-nav {
        display: none;
      }
    }

    .text-display {
      @apply font-display tracking-tight;
    }

    .text-mono {
      @apply font-mono;
    }

    .text-secondary {
      @apply text-text-secondary-light dark:text-text-secondary-dark;
    }

    .surface {
      @apply bg-surface-light dark:bg-surface-dark;
    }

    .focus-ring {
      @apply focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 focus:ring-offset-surface-light dark:focus:ring-offset-surface-dark;
    }

    .theme-toggle {
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .theme-toggle .sun {
      transform: rotate(0deg);
      opacity: 1;
    }

    .theme-toggle .moon {
      transform: rotate(-90deg);
      opacity: 0;
    }

    .dark .theme-toggle .sun {
      transform: rotate(90deg);
      opacity: 0;
    }

    .dark .theme-toggle .moon {
      transform: rotate(0deg);
      opacity: 1;
    }
  </style>
</head>
<body class="min-h-screen">
<main class="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 py-8 px-4 sm:px-6 lg:px-8">
  <div class="max-w-5xl mx-auto">
    <!-- Header Section -->
    <div class="flex items-center justify-between mb-12">
      <a href="index.html" class="group flex items-center text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 transition-colors duration-200">
        <div class="p-2 rounded-lg bg-white dark:bg-gray-800 shadow-sm group-hover:shadow-md transition-shadow duration-200 mr-3">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 group-hover:-translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
          </svg>
        </div>
        <span class="font-medium text-gray-700 dark:text-gray-300">Back to Home</span>
      </a>
      
      <div class="flex items-center space-x-4">
        <div class="hidden md:flex flex-col items-end">
          <span id="user-name" class="text-sm font-medium text-gray-700 dark:text-gray-300">Hello, </span>
          <span class="text-xs text-gray-500 dark:text-gray-400">Welcome back</span>
        </div>
        <div class="relative">
        <img <img id="user-photo" src="" alt="profile picture" alt="profile picture" class="w-10 h-10 rounded-full border-2 border-white dark:border-gray-700 shadow-md">
          <div class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-gray-800"></div>
        </div>
      </div>
    </div>



<script>
document.addEventListener("DOMContentLoaded", async () => {
  const BASE_URL = "https://vuno-1.onrender.com";

  // üîë Get tokens from index.html (localStorage)
  const accessToken = localStorage.getItem("authToken");
  const refreshToken = localStorage.getItem("refreshToken");

  if (!accessToken || !refreshToken) {
    console.warn("‚ö†Ô∏è No tokens found. Redirecting to login...");
    window.location.href = "signin.html";
    return;
  }

  // üîÑ Helper to refresh access token if expired
  async function refreshAccessToken() {
    try {
      const response = await fetch(`${BASE_URL}/token/refresh/`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ refresh: refreshToken })
      });

      if (!response.ok) throw new Error("Failed to refresh token");

      const data = await response.json();
      localStorage.setItem("authToken", data.access);
      console.log("üîÑ Token refreshed!");
      return data.access;
    } catch (err) {
      console.error("‚ùå Refresh failed:", err);
      localStorage.removeItem("authToken");
      localStorage.removeItem("refreshToken");
      window.location.href = "signin.html";
      return null;
    }
  }

  // üîÑ Fetch with auto-refresh retry
  async function fetchWithAuth(url, options = {}) {
    options.headers = {
      ...options.headers,
      "Authorization": `Bearer ${accessToken}`,
      "Content-Type": "application/json"
    };

    let response = await fetch(url, options);

    if (response.status === 401 && refreshToken) {
      const newToken = await refreshAccessToken();
      if (newToken) {
        options.headers["Authorization"] = `Bearer ${newToken}`;
        response = await fetch(url, options);
      }
    }

    return response;
  }

  // ===============================
  // üîπ Fetch Profile
  // ===============================
  try {
    const response = await fetchWithAuth(`${BASE_URL}/profile/`);
    if (!response.ok) throw new Error("Failed to fetch profile");

    const data = await response.json();
    console.log("‚úÖ Profile loaded:", data);

    // Set name
    const fullName = data.first_name || data.last_name
      ? `${data.first_name || ""} ${data.last_name || ""}`.trim()
      : data.username;

    const userNameElem = document.getElementById("user-name");
    if (userNameElem) userNameElem.textContent = `Hello, ${fullName}`;

    // Set profile image or initial
    const profileImage = document.getElementById("user-photo");
    const profileInitial = document.createElement("div");
    profileInitial.id = "profile-initial";
    profileInitial.className = "w-10 h-10 rounded-full bg-gray-500 text-white flex items-center justify-center";
    
    if (data.profile && (data.profile.photo || data.profile.image)) {
      profileImage.src = data.profile.photo || data.profile.image;
      profileImage.style.display = "block";
      if (profileInitial.parentNode) profileInitial.parentNode.removeChild(profileInitial);
    } else {
      profileImage.style.display = "none";
      const parent = profileImage.parentNode;
      parent.appendChild(profileInitial);
      profileInitial.textContent = fullName.charAt(0).toUpperCase();
    }

  } catch (err) {
    console.error("‚ùå Error loading profile:", err);
  }
});
</script>








    <!-- Hero Section -->
    <div class="text-center mb-16">
      <h1 class="text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-4">Start or Join a Meeting</h1>
      <p class="text-xl text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">Connect with your team through high-quality video meetings with crystal clear audio and seamless screen sharing</p>
    </div>

    <!-- Action Cards Grid -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-16">
      <!-- Join Meeting Card -->
      <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 overflow-hidden group">
        <div class="p-6">
          <div class="w-14 h-14 rounded-xl bg-blue-50 dark:bg-blue-900/30 flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-600 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z" />
            </svg>
          </div>
          <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">Get Join Info</h3>
          <p class="text-gray-600 dark:text-gray-400 mb-6">Share meeting details with participants</p>
          <button id="join-info-button" class="w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 mt-0 inline-block items-center justify-center">
            Generate Link
          </button>
        </div>
      </div>

      <!-- Start Meeting Card -->
      <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 overflow-hidden group">
        <div class="p-6">
          <div class="w-14 h-14 rounded-xl bg-green-50 dark:bg-green-900/30 flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-600 dark:text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
            </svg>
          </div>
          <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">Start Instant Meeting</h3>
          <p class="text-gray-600 dark:text-gray-400 mb-6">Begin a meeting right away</p>
          <a href="contact.html" class="w-full py-3 px-4 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 inline-flex mt-2 items-center justify-center">
    Start Now
</a>
        </div>
      </div>

      <!-- Schedule Meeting Card -->
      <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 overflow-hidden group">
        <div class="p-6">
          <div class="w-14 h-14 rounded-xl bg-purple-50 dark:bg-purple-900/30 flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-purple-600 dark:text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
          </div>
          <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">Schedule Meeting</h3>
          <p class="text-gray-600 dark:text-gray-400 mb-6">Plan a meeting for later</p>
          <button class="w-full py-3 px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800">
            Schedule
          </button>
        </div>
      </div>
    </div>

    <!-- Illustration Section -->
    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg overflow-hidden">
      <div class="md:flex items-center">
        <div class="md:w-1/2 p-8 md:p-12">
          <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">Premium Meeting Experience</h2>
          <p class="text-gray-600 dark:text-gray-400 mb-6">Enjoy crystal clear video, noise cancellation, screen sharing, and real-time collaboration tools designed for productive meetings.</p>
          <ul class="space-y-3">
            <li class="flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500 mr-3" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
              </svg>
              <span class="text-gray-700 dark:text-gray-300">HD video quality</span>
            </li>
            <li class="flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500 mr-3" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
              </svg>
              <span class="text-gray-700 dark:text-gray-300">Noise cancellation</span>
            </li>
            <li class="flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500 mr-3" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
              </svg>
              <span class="text-gray-700 dark:text-gray-300">Screen sharing</span>
            </li>
          </ul>
        </div>
        <div class="md:w-1/2">
          <img src="call.jpg" alt="People having a video call" class="w-full h-64 md:h-80 object-cover">
        </div>
      </div>
    </div>
  </div>
<!-- Join Meeting Modal -->
<div id="join-modal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 px-4 transition-opacity duration-300">
  <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 max-w-md w-full shadow-2xl transform transition-all duration-300 scale-95 opacity-0">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Join Meeting</h2>
      <button id="close-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors duration-200">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
    
    <div class="mb-6">
      <p class="text-gray-600 dark:text-gray-400 mb-4">Share this link with participants to join your meeting:</p>
      <div class="flex items-center gap-2 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600">
        <p id="meeting-link" class="text-sm font-medium text-gray-900 dark:text-white truncate flex-1">
          Loading link...
        </p>
        <button id="copy-button" class="flex-shrink-0 p-2 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-gray-600 rounded-md transition-colors duration-200" aria-label="Copy link">
          <img src='duplicate.png' class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
           
        </button>
      </div>
    </div>

    <div class="flex gap-3">
      <button class="flex-1 py-3 px-4 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg font-medium transition-colors duration-200">
        Share via
      </button>
      <button id="close-modal-btn" class="flex-1 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800">
        Close
      </button>
    </div>
  </div>
</div>
 
</main>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const shareButton = Array.from(document.querySelectorAll("button"))
                           .find(btn => btn.textContent.trim() === "Share via");

  const modal = document.getElementById("join-modal");
  const modalContent = modal.querySelector(".transform");
  const closeButton = document.getElementById("close-modal-btn");

  // Close modal
  function closeModal() {
    modalContent.classList.add("scale-95", "opacity-0");
    setTimeout(() => modal.classList.add("hidden"), 300);
  }

 if (shareButton) {
  shareButton.addEventListener("click", async () => {
    const meetingUrl = document.getElementById("meeting-link").textContent.trim();
    if (!meetingUrl) return alert("‚ö†Ô∏è No meeting link available");

    // Disable button while sharing
    shareButton.disabled = true;

    if (navigator.share) {
      try {
        await navigator.share({
          title: "Join my meeting",
          url: meetingUrl
        });
        alert("‚úÖ Meeting link shared!");
      } catch (err) {
        console.error("Share failed:", err);
        alert("‚ö†Ô∏è Share failed or cancelled.");
      } finally {
        shareButton.disabled = false;
      }
    } else {
      try {
        await navigator.clipboard.writeText(meetingUrl);
        alert("‚úÖ Link copied to clipboard (Web Share not supported)");
      } catch (err) {
        alert("‚ùå Failed to copy link: " + err.message);
      } finally {
        shareButton.disabled = false;
      }
    }
  });
}
  closeButton.addEventListener("click", closeModal);
  document.getElementById("close-modal").addEventListener("click", closeModal);
  modal.addEventListener("click", (e) => {
    if (e.target === modal) closeModal();
  });
  

  
});

</script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const joinButton = document.getElementById("join-info-button");
  const copyButton = document.getElementById("copy-button");
  const modal = document.getElementById("join-modal");
  const modalContent = modal.querySelector(".transform");
  const meetingLinkElem = document.getElementById("meeting-link");

  let meetingUrl = ""; // store meeting URL globally

  joinButton.addEventListener("click", async () => {
    const token = localStorage.getItem("authToken");
    if (!token) return alert("‚ö†Ô∏è You must log in first");

    try {
      // Call backend to create a meeting
      const res = await fetch("https://vuno-1.onrender.com/call/meetings/create/", {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${token}`,
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ title: "Instant Meeting" }),
      });

      if (!res.ok) throw new Error("Failed to create meeting");
      const data = await res.json();
      const meetingId = data.meeting_id;

      // Build URL with real backend UUID
      meetingUrl = `${window.location.origin}/contact.html?meeting=${meetingId}`;
      meetingLinkElem.textContent = meetingUrl;

      // Show modal
      modal.classList.remove("hidden");
      setTimeout(() => modalContent.classList.remove("scale-95", "opacity-0"), 10);

    } catch (err) {
      console.error(err);
      alert("‚ùå " + err.message);
    }
  });

  // Copy meeting link
  copyButton.addEventListener("click", async () => {
    try {
      if (!meetingUrl) throw new Error("No meeting link to copy");
      await navigator.clipboard.writeText(meetingUrl);

      // Show a checkmark briefly
      const originalHTML = copyButton.innerHTML;
      copyButton.innerHTML = `
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
        </svg>
      `;
      setTimeout(() => copyButton.innerHTML = originalHTML, 2000);
    } catch (err) {
      alert("‚ùå Failed to copy link: " + err.message);
    }
  });
});
</script>



</body>
</html>